{% extends "base.html" %}
{% block title %}Wargame · Exercise Supervisor{% endblock %}

{% block content %}
<div class="container">
  <h1>Wargame — Exercise Supervisor</h1>

  <div class="super-metrics">
    <div class="metric">
      <h3>Radio delays</h3>
      <div>Avg {{ metrics.radio.avg|mmss }}, Min {{ metrics.radio.min|mmss }}, Max {{ metrics.radio.max|mmss }} <span class="muted">(mm:ss)</span></div>
    </div>
    <div class="metric">
      <h3>Ramp delays</h3>
      <div>Avg {{ metrics.ramp.avg|mmss }}, Min {{ metrics.ramp.min|mmss }}, Max {{ metrics.ramp.max|mmss }} <span class="muted">(mm:ss)</span></div>
    </div>
    <div class="metric">
      <h3>Inventory delays</h3>
      <div>Avg {{ metrics.inventory.avg|mmss }}, Min {{ metrics.inventory.min|mmss }}, Max {{ metrics.inventory.max|mmss }} <span class="muted">(mm:ss)</span></div>
    </div>
    <div class="metric throughput" style="margin-left:auto;">
      <h3>Air Cargo Throughput (last hour)</h3>
      <div>{{ stats.aircraft_entries_per_hour }} flights / {{ stats.air_cargo_entries_per_hour }} lb</div>
    </div>
  </div>

  <div class="super-settings">
    <h2 style="margin-top:1.25rem;">Difficulty settings</h2>
    {% set pretty = {
      'Radio message rate (per hour)': settings.get('radio_rate', 0),
      'Radio: batch inbox': 'Yes' if settings.get('radio_use_batch') == 'yes' else 'No',
      'Radio: count batch toward cap': 'Yes' if settings.get('radio_count_batch') == 'yes' else 'No',
      'Inventory batch rate (per hour)': settings.get('inv_rate', 0),
      'Ramp request rate (per hour)': settings.get('ramp_rate', 0),
      'Inbound/outbound balance band (±%)': settings.get('balance_pct', 20),
      'Max simultaneous Radio items': settings.get('max_radio', 3),
      'Max simultaneous Ramp cue cards': settings.get('max_ramp', 3),
      'Max simultaneous Inventory batches': settings.get('max_inventory', 3)
    } %}
    <table class="table wg-settings">
      <tbody>
      {% for label, val in pretty.items() %}
        <tr><th>{{ label }}</th><td>{{ val }}</td></tr>
      {% endfor %}
      </tbody>
    </table>
  </div>

  <form class="wg-exit-form" method="post"
        action="{{ url_for('wargame_exit_role') }}"
        onsubmit="return confirm('Exit your role and choose a new one?');">
    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
    <button type="submit" class="btn btn-yellow">Exit role</button>
  </form>
</div>
{% endblock %}
