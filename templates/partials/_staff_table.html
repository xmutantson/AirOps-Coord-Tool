<table class="table staff-table" style="width:100%; border-collapse:separate; border-spacing:0;">
  <thead>
    <tr style="border-bottom:1px solid #ddd;">
      <th style="text-align:left; padding:.4rem;">Name</th>
      <th style="text-align:left; padding:.4rem;">Organization</th>
      <th style="text-align:left; padding:.4rem;">EMC</th>
      <th style="text-align:left; padding:.4rem;">Status</th>
      <th style="text-align:left; padding:.4rem;">Shift Start (UTC)</th>
      <th style="text-align:right; padding:.4rem;">Current</th>
      <th style="text-align:right; padding:.4rem;">Total ({{ window }})</th>
      <th style="text-align:center; padding:.4rem;">Action</th>
    </tr>
  </thead>
  <tbody>
    {% for r in rows %}
      <tr id="staff-{{ r.id }}" style="border-bottom:1px solid #eee;">
        <td style="padding:.4rem;">{{ r.name }}</td>
        <td style="padding:.4rem;">{{ r.organization or '—' }}</td>
        <td style="padding:.4rem;">{{ r.emc or '—' }}</td>
        <td style="padding:.4rem;">
          {% if r.on_duty %}
            <span style="color:#0a0; font-weight:600;">On Duty</span>
          {% else %}
            <span class="muted">Off Duty</span>
          {% endif %}
        </td>
        <td style="padding:.4rem;">
          {% set s = r.shift_start_utc %}
          {{ s[:16]|replace('T',' ') if s else '—' }}
        </td>
        <td style="padding:.4rem; text-align:right;">{{ r.current_elapsed_hhmm }}</td>
        <td style="padding:.4rem; text-align:right;">{{ r.total_in_window_hhmm }}</td>
        <td style="padding:.4rem; text-align:center;">
          <form class="toggle-form" method="post" action="{{ url_for('staff.staff_toggle', staff_id=r.id) }}">
            <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
            <input type="hidden" name="window" value="{{ window }}">
            <input type="hidden" name="on_off" value="{{ 'off' if r.on_duty else 'on' }}">
            <button type="submit"
                    class="button small"
                    style="padding:.3rem .6rem; border:1px solid #ccc; border-radius:.35rem; background:#fafafa;">
              {{ 'Clock Out' if r.on_duty else 'Clock In' }}
            </button>
          </form>
          <button class="button small"
                  data-action="delete-staff"
                  data-id="{{ r.id }}"
                  style="margin-top:.35rem; padding:.25rem .5rem; border:1px solid #d33; color:#d33; background:#fff; border-radius:.35rem;">
            Delete
          </button>
        </td>
      </tr>
    {% else %}
      <tr>
        <td colspan="8" class="muted" style="padding:.75rem; text-align:center;">No staff yet — add someone above.</td>
      </tr>
    {% endfor %}
  </tbody>
  <tfoot>
    <tr>
      <td colspan="8" class="muted" style="padding:.5rem; text-align:right; font-size:.85rem;">
        Times shown in UTC · Window: {{ window }}
      </td>
    </tr>
  </tfoot>
</table>
